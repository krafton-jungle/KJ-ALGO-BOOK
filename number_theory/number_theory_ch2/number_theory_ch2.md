# 정수론(Number Theory)

## 공약수와 공배수

### 공약수(Common Divisor)란?

**공약수(Common Divisor)**란, $0$이 아닌 정수 $a_1, a_2, ... a_n$이 주어졌을 때, 모든 정수들을 나눌 수 있는 정수 $d$를 **공약수**라고 한다.

예를들어, $12$의 약수와 $18$의 약수로 공약수를 구한다면 다음과 같다.

예시 : 
- $12$의 약수 : $1, 2, 3, 4, 6, 12$
- $18$의 약수 : $1, 2, 3, 6, 9, 18$
- 따라서 $12$와 $18$의 공약수 : $1, 2, 3, 6$

### 공배수(Common Multiple)란?

**공배수(Common Multiple)**란, $0$이 아닌 정수 $a_1, a_2, ... a_n$이 주어졌을 때, 모든 정수들의 공통된 배수인 정수 $m$를 **공배수**라고 한다.

예를들어, $4$의 배수와 $6$의 배수로 공배수를 구한다면 다음과 같다.

예시 : 
- $4$의 약수 : $4, 8, 12, 16, 20, 24, ...$
- $6$의 약수 : $6, 12, 18, 24, 30, 36, ...$
- 따라서 $4$와 $6$의 공배수 : $12, 24, ...$

## 최대공약수와 최소공배수

### 최대공약수(Greatest Common Divisor, GCD)란?

정수 $a_1, a_2, ... a_n$이 주어졌을 때, 해당하는 공약수 중에서 가장 큰 양의 정수를 **최대공약수(Greatest Common Divisor, GCD)**라고 하며, $gcd(a_1, a_2, ... a_n)$로 표기한다.

예를 들어, $12$와 $18$의 공약수는 $1,2,3,6$이며, 이 중에서 가장 큰 수는 $6$이므로 $gcd(12,18)=6$이 된다.

## 최소공배수(Least Common Multiple, LCM)

정수 $a_1, a_2, ... a_n$이 주어졌을 때, 해당하는 공배수 중에서 가장 작은 양의 정수를 **최소공배수(Least Common Multiple, LCM)**라고 하며, $lcm(a_1, a_2, ... a_n)$로 표기한다.

예를 들어, $4$와 $6$의 공배수는 $12,24,36,...$ 이며, 이 중에서 가장 작은 양수는 $12$이므로 $lcm(4,6)=12$이 된다.

## 유클리드 호제법

### 유클리드 호제법(Euclidean Algorithm)이란?

**유클리드 호제법(Euclidean Algorithm)**은 두 정수의 **최대공약수**를 찾는 알고리즘이다.
이 방법은 큰 수와 작은 수 사이의 최대 공약수는 **큰 수를 작은 수로 나눈 나머지를 구하는 과정을 반복하다가 결국 나머지가 0이 될 때, 마지막으로 나눈 수가 최대공약수**라는 원리를 이용하여 최대공약수를 구하는 방식이다.

예시 : 
- 두 양의 정수 $a, b (a>b)$의 최대공약수를 찾고 싶은 경우 :
- $a$를 $b$로 나눈 나머지 $r_1$​을 계산 : $a=bq_1​+r_1​$
- $b$를 $r_1$​로 나눈 나머지 $r_2$을 계산 : $b=r_1​q_2​+r_2​$
- $r_1$​를 $r_2$​로 나눈 나머지 $r_3$을 계산 : $r_1​=r_2​q_3​+r_3​$
- $...$ 이 과정을 반복하면, 유한한 횟수 안에 나머지 0에 도달
$$r_{k−2}​=r_{k−1}​q_k​+r_k$$
$$r_{k−1}​=r_k​q_{k+1}+0$$
- 나머지 $0$에 도달 시, $r_k$​가 $a$와 $b$의 최대공약수

#### 증명

최대공약수 $d=gcd(a,b)$가 있고 $c$를 $a,b$의 임의의 공약수라고 할 때, $d=ax+by$를 만족하는 정수 $x,y$가 존재한다.
또한 $c$는 $a, b$의 임의의 공약수이므로, 이는 즉, $c∣a, c∣b$가 된다.
따라서 약수의 성질에 의해 $c∣(ax+by)$가 성립한다.
이때 $(ax+by)$에서 $d$는  $d=ax+by$이 성립하므로, $c∣d$ 또한 성립할 수 있게 된다.
때문에 $a,b$의 모든 공약수는 최대공약수 $d$의 약수이다.


### 확장 유클리드 호제법(Extended Euclidean Algorithm)

**확장 유클리드 호제법**은 두 정수 $a, b$의 최대공약수 $gcd(a, b)$를 구하는 것을 넘어, $ax + by = gcd(a, b)$를 만족하는 정수 해 $x, y$를 찾는 알고리즘이다. 이 방정식은 **베주 항등식(Bézout's identity)**이라고도 한다.

이 알고리즘은 모듈러 역원을 계산하는 데 핵심적으로 사용된다.

#### 과정

확장 유클리드 호제법은 유클리드 호제법의 과정을 역으로 추적하여 $x$와 $y$를 찾는다.

예시: $a=240, b=46$의 최대공약수와 베주 항등식의 해 $x, y$를 찾는 경우이다.

1.  **유클리드 호제법 적용**
    - $240 = 5 \times 46 + 10$
    - $46 = 4 \times 10 + 6$
    - $10 = 1 \times 6 + 4$
    - $6 = 1 \times 4 + 2$
    - $4 = 2 \times 2 + 0$
    - 따라서 $gcd(240, 46)$는 $2$이다.

2.  **역으로 추적하여 $gcd(a,b)$를 $a$와 $b$로 표현**
    - $2 = 6 - 1 \times 4$
    - 위 식의 $4$를 $10 = 1 \times 6 + 4 \implies 4 = 10 - 1 \times 6$으로 대체한다.
      $2 = 6 - 1 \times (10 - 1 \times 6) = 2 \times 6 - 1 \times 10$
    - 위 식의 $6$을 $46 = 4 \times 10 + 6 \implies 6 = 46 - 4 \times 10$으로 대체한다.
      $2 = 2 \times (46 - 4 \times 10) - 1 \times 10 = 2 \times 46 - 9 \times 10$
    - 마지막으로 위 식의 $10$을 $240 = 5 \times 46 + 10 \implies 10 = 240 - 5 \times 46$으로 대체한다.
      $2 = 2 \times 46 - 9 \times (240 - 5 \times 46) = 2 \times 46 - 9 \times 240 + 45 \times 46 = 47 \times 46 - 9 \times 240$

3.  **결과**
    - $240(-9) + 46(47) = 2$
    - 따라서 $x = -9, y = 47$이다.

## 모듈러 산술

### 합동식(Congruence)

두 정수 $a, b$를 양의 정수 $m$으로 나눈 나머지가 같을 때, "$a$와 $b$는 법 $m$에 대해 합동이다"라고 하고 다음과 같이 표기한다.

$ a \equiv b \pmod{m} $

이는 $m | (a-b)$와 동치이다. 즉, $a-b$가 $m$의 배수임을 의미한다.

예시:
- $10 \equiv 4 \pmod{6}$ (10을 6으로 나눈 나머지는 4, 4를 6으로 나눈 나머지도 4이다)
- $17 \equiv 5 \pmod{12}$

### 모듈러 연산의 성질

$a \equiv b \pmod{m}$ 이고 $c \equiv d \pmod{m}$ 일 때 다음이 성립한다.

- **덧셈**: $a+c \equiv b+d \pmod{m}$
- **뺄셈**: $a-c \equiv b-d \pmod{m}$
- **곱셈**: $ac \equiv bd \pmod{m}$

## 모듈러 역원(Modular Inverse)

정수 $a$에 대해 다음을 만족하는 정수 $x$가 존재할 때, $x$를 법 $m$에 대한 $a$의 **모듈러 곱셈 역원**이라고 한다.

$ ax \equiv 1 \pmod{m} $

$a$의 역원은 $a^{-1}$로 표기한다. 모듈러 역원은 $gcd(a, m) = 1$일 때만 존재한다. 즉, $a$와 $m$이 서로소일 때만 존재한다.

모듈러 역원은 확장 유클리드 호제법을 사용하여 찾을 수 있다. $ax + my = gcd(a, m)$ 에서 $gcd(a, m)=1$ 이므로 $ax+my=1$ 이다. 이 식에 법 $m$을 적용하면 $ax \equiv 1 \pmod{m}$ 이므로, $x$가 바로 $a$의 모듈러 역원이 된다.

## 페르마의 소정리(Fermat's Little Theorem)

$p$가 소수이고 $a$가 $p$의 배수가 아닌 정수일 때, 다음이 성립한다.

$ a^{p-1} \equiv 1 \pmod{p} $

이를 이용하면 특정 조건 하에서 모듈러 역원을 쉽게 계산할 수 있다. 위 식의 양변에 $a^{-1}$을 곱하면 $a^{p-2} \equiv a^{-1} \pmod{p}$ 이므로, $a^{p-2}$가 법 $p$에 대한 $a$의 역원이 된다.

## 오일러의 토션트 정리(Euler's Totient Theorem)

오일러의 토션트 함수 $\phi(n)$은 $1$부터 $n$까지의 양의 정수 중에서 $n$과 서로소인 수의 개수를 나타낸다.

오일러의 토션트 정리는 페르마의 소정리를 일반화한 것으로, $a$와 $n$이 서로소인 양의 정수일 때 다음이 성립한다.

$ a^{\phi(n)} \equiv 1 \pmod{n} $

만약 $n$이 소수 $p$라면, $\phi(p) = p-1$이므로 페르마의 소정리와 같아진다.

